# 문제 링크 : https://school.programmers.co.kr/learn/courses/30/lessons/131118


# JOIN을 이용해 TABLE을 만든 뒤 조건대로 진행 (안전하게 INNER JOIN을 수행하자)

SELECT A.REST_ID , REST_NAME , FOOD_TYPE ,FAVORITES, ADDRESS , ROUND(AVG(REVIEW_SCORE) , 2) AS SCORE
FROM REST_INFO AS A LEFT JOIN REST_REVIEW AS B ON A.REST_ID = B.REST_ID
WHERE ADDRESS LIKE '서울%' AND REVIEW_SCORE IS NOT NULL
GROUP BY REST_NAME
#HAVING SCORE IS NOT NULL
ORDER BY SCORE DESC , FAVORITES DESC
